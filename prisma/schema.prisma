// This is the Prisma schema file,

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

// User account details
model User {
  id               Int               @id @default(autoincrement())
  kindeId          String            @unique
  username         String            @unique
  email            String            @unique
  name             String
  role             String            @default("basic") // TODO enum not supported on sqlite, (basic, middleman, admin)
  sellerDetails    SellerDetails?
  buyerDetails     BuyerDetails?
  middlemanDetails MiddlemanDetails?
}

// Contains records for a buyer 
model BuyerDetails {
  id            Int     @id @default(autoincrement())
  userId        String  @unique
  purchaseCount Int     @default(0)
  orders        Order[] // orders for a purchase
  user          User    @relation(fields: [userId], references: [kindeId])
}

// Contains records for a seller
model SellerDetails {
  id         Int       @id @default(autoincrement())
  userId     String    @unique
  saleCount  Int       @default(0)
  sellerType String    @default("new") // TODO convert to enum, (new, experienced)
  products   Product[] // seller can have many products
  orders     Order[] // seller can have many orders for sale
  user       User      @relation(fields: [userId], references: [kindeId])
}

model Product {
  id Int @id @default(autoincrement())
  title String
  description String
  price Float
  imagePath String
  seller User @relation(fields: [sellerKindeId], references: [kindeId])
  sellerKindeId String
}